<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>How to Git?</title> <meta name="description" content="Another cookbook about git. I hereby expose some recipes I encounter quite often. This post islikely to evolve in the future and to be completed on purpose."> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://ktorz.github.io/2015/12/10/how_to_git/"> <link rel="alternate" type="application/rss+xml" title="KtorZ's Blog" href="http://ktorz.github.io/feed.xml"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="alternate" type="application/atom+xml" title="" href="http://ktorz.github.io/feed.xml" /> <script src="/assets/js/modernizr.js"></script> <!-- Google Analytics --> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/about">About</a></li> <li><a href="http://github.com/KtorZ" target="_blank"><i class="icon icon-github"></i> Github</a></li> <li><a href="http://linkedin.com/in/matthias-benkort-47186a57" target="_blank"><i class="icon icon-linkedin"></i> LinkedIn</a></li> <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> RSS</a></li> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div class="intro-in"> <h1 class="post-title" itemprop="name headline">How to Git?</h1> <p class="post-meta"><time datetime="2015-12-10T09:53:00+01:00" itemprop="datePublished">Dec 10, 2015</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Matthias Benkort</span></span></p> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>Another cookbook about git. I hereby expose some recipes I encounter quite often. This post is likely to evolve in the future and to be completed on purpose.</p> <h2 id="summary">Summary</h2> <p>How to…</p> <ul> <li><a href="#change-the-last-commit">change the last commit</a></li> <li><a href="#change-the-last-commit-message">change the last commit message</a></li> <li><a href="#rebase-and-preserve-commit-dates">rebase and preserve commit dates</a></li> <li><a href="#make-an-empty-commit">make an empty commit</a></li> <li><a href="#change-messages-of-a-set-of-commits">change messages of a set of commits</a></li> <li><a href="#change-the-commit-date-of-an-old-commit">change the commit date of an old commit</a></li> <li><a href="#import-only-a-subdirectory-of-an-existing-repository">import only a subdirectory of an existing repository</a></li> <li><a href="#excludes-some-files-by-default-always">excludes some files by default, always</a></li> <li><a href="#show-all-commits-related-to-a-specific-file">show all commits related to a specific file</a></li> <li><a href="#make-git-cli-get-rid-of-small-typos">make git cli get rid of small typos</a></li> <li><a href="#create-a-new-detached-branch">create a new detached branch</a></li> <li><a href="#temporary-ignore-files">temporary ignore files</a></li> </ul> <p><strong>last changes: 01-02-2016</strong></p> <h2 id="recipes">Recipes</h2> <h3 id="change-the-last-commit">… change the last commit</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git add ...
git commit --amend -C HEAD</code></pre></figure> <p>Incidentally, <code>-C</code> option (as well as <code>-c</code> that also let you edit the message) can be used to re-use any any commit’s message you wish. By giving it <code>HEAD</code>, we just ask for the last one.</p> <h4 id="change-the-last-commit-message">… change the last commit message</h4> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git add <span class="o">[</span>whatever<span class="o">]</span>
git commit --amend -m <span class="s2">&quot;&lt;whatever&gt;&quot;</span></code></pre></figure> <h3 id="rebase-and-preserve-commit-dates">… rebase and preserve commit dates</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git rebase --onto &lt;newbase&gt; &lt;branch&gt; &lt;upstream&gt;
git rebase --committer-date-is-author-date &lt;newbase&gt;</code></pre></figure> <p>By default, a <code>git rebase</code> does not overwrite the author dates. Thus, after having perform the rebase, one can still ask git to rewrite all commit dates and make them match their author</p> <h3 id="make-an-empty-commit">… make an empty commit</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git commit --allow-empty -m <span class="s2">&quot;&lt;whatever&gt;&quot;</span></code></pre></figure> <h3 id="change-messages-of-a-set-of-commits">… change messages of a set of commits</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git filter-branch --msg-filter <span class="s1">&#39;echo &quot;&lt;whatever&gt; $(cat)&quot;&#39;</span> &lt;branch&gt;...&lt;REF_LIMIT&gt;</code></pre></figure> <p>Here, <code>$(cat)</code> prints the previous commit message such that we can append or prepend elements to that message. Also, by default (without <code>&lt;branch&gt;...&lt;REF_LIMIT&gt;</code>), the transformation will apply to the entire branch. By specifying a <code>REF_LIMIT</code>, which is a commit ref, it is possible to stop the process on that specified commit (exclusive, the <code>REF_LIMIT</code> isn’t affected).</p> <h3 id="change-the-commit-date-of-an-old-commit">… change the commit date of an old commit</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git filter-branch --env-filter <span class="se">\</span>
<span class="s1">&#39;if [ $GIT_COMMIT = &lt;whatever_commit_hash&gt; ]</span>
<span class="s1"> then</span>
<span class="s1"> export GIT_AUTHOR_DATE=&lt;whatever_date&gt;</span>
<span class="s1"> export GIT_COMMITTER_DATE=&lt;whatever_date&gt;</span>
<span class="s1"> fi&#39;</span></code></pre></figure> <p>Git supports several date format, for instance: <code>dd.mm.aaaaThh:mm</code> is one of them and is seemingly handy.</p> <h3 id="import-only-a-subdirectory-of-an-existing-repository">… import only a subdirectory of an existing repository</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git config core.sparsecheckout <span class="nb">true</span>
<span class="nb">echo </span>whatever/subdirectory &gt;&gt; .git/info/sparse-checkout
git fetch &lt;whatever-remote&gt;
git <span class="nb">read</span>-tree -mu &lt;whatever-remote&gt;/&lt;whatever-branch&gt;</code></pre></figure> <h3 id="excludes-some-files-by-default-always">… excludes some files by default, always</h3> <p>Create a global <code>.gitignore</code>, somewhere in a safe and soft place:</p> <p><strong>.gitignore</strong></p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">.DS_Store
Thumbs.db

<span class="c">### Vim ###</span>
<span class="o">[</span>._<span class="o">]</span>*.s<span class="o">[</span>a-w<span class="o">][</span>a-z<span class="o">]</span>
<span class="o">[</span>._<span class="o">]</span>s<span class="o">[</span>a-w<span class="o">][</span>a-z<span class="o">]</span>
*.un~
Session.vim
.netrwhist
*~</code></pre></figure> <p>And, either modify your <code>.gitconfig</code> if any, or use the CLI directly:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git config --global core.excludesfile<span class="o">=</span>/path/to/.gitignore</code></pre></figure> <p>Files such as buffers created by vim shouldn’t be present in a project <code>.gitignore</code>. This should semantically be related to the project itself, not to the tools or IDE one’s using.</p> <h3 id="show-all-commits-related-to-a-specific-file">… show all commits related to a specific file</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git log --follow &lt;whatever-file&gt;</code></pre></figure> <p>The <code>-p</code> option might be added to also show the content of each commit and to thereby give an overview of all changes that lead to the current file content.</p> <h3 id="make-git-cli-get-rid-of-small-typos">… make git cli get rid of small typos</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git config --global help.autocorrect<span class="o">=</span>1</code></pre></figure> <p>Simple, efficient, clean.</p> <h3 id="create-a-new-detached-branch">… create a new detached branch</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git checkout --orphan &lt;whatever-branch&gt;
git reset</code></pre></figure> <p>This will allow you to start a complete new branch which as to link to another one. A starting point for the new branch can also be specified alongside the branch’s name.</p> <h3 id="temporary-ignore-files">… temporary ignore files</h3> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git update-index --assume-unchanged &lt;whatever-file&gt;</code></pre></figure> <p>And this could be undone with:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">git update-index --no-assume-unchanged &lt;whatever-file&gt;</code></pre></figure> <p>Doing this, you can simply ignore changes that occurs on a file stored in the git-index. Why doing such a thing ? For instance, you’ll have to change the content of a file during a small dev session (you add some log lines or some other irrelevant content inside) but the real effort concerns other files in the repo. You still want to commit changes and to operate as usual, then, you can temporary ignore those files. Also, if you have for instance some compressed zip files manipulated only by the compiler or any external tools, you may want to ship only those compressed zip files and not the garbage generated by the tools afterwards. Then, you can simply ignore changes to those files but still add them (–force) once and assume them unchanged in the future so that the only version git will care about is the first one you ever committed. That’s tricky but it sometimes useful.</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="http://github.com/KtorZ" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://linkedin.com/in/matthias-benkort-47186a57" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/mbenkort" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->