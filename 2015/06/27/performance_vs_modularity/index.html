<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Performance VS Modularity</title> <meta name="description" content="One of the greatest features of Titanium relies on its high modularity. The SDK can be easilyextended using modules, and when it comes to Alloy, code can be ..."> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="http://ktorz.github.io/2015/06/27/performance_vs_modularity/"> <link rel="alternate" type="application/rss+xml" title="KtorZ's Blog" href="http://ktorz.github.io/feed.xml"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="alternate" type="application/atom+xml" title="" href="http://ktorz.github.io/feed.xml" /> <script src="/assets/js/modernizr.js"></script> <!-- Google Analytics --> </head> <body"> <main class="wrapper"> <header class="site-header"> <a href="#navbar" id="menu-burger" class="menu-burger">Menu <span class="nav-icon"></span> <svg x="0px" y="0px" width="54px" height="54px" viewBox="0 0 54 54"> <circle fill="transparent" stroke="#000000" stroke-width="1" cx="27" cy="27" r="25" stroke-dasharray="157 157" stroke-dashoffset="157"></circle> </svg> </a> <div id="navbar" class="navbar"> <div class="navigation-wrapper"> <div class="half-block"> <h2>Navigation</h2> <nav> <ul class="primary-nav"> <li><a href="/">Blog</a></li> <li><a href="/references">References</a></li> <li><a href="/about">About</a></li> <li><a href="http://github.com/KtorZ" target="_blank"><i class="icon icon-github"></i> Github</a></li> <li><a href="http://linkedin.com/in/matthias-benkort-47186a57" target="_blank"><i class="icon icon-linkedin"></i> LinkedIn</a></li> <li><a href="/feed.xml" target="_blank"><i class="icon icon-feed"></i> RSS</a></li> </ul> </nav> </div> </div> </div> </header> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header intro"> <div class="intro-in"> <h1 class="post-title" itemprop="name headline">Performance VS Modularity</h1> <p class="post-meta"><time datetime="2015-06-27T10:01:25+02:00" itemprop="datePublished">Jun 27, 2015</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Matthias Benkort</span></span></p> </div> </header> <div class="post-content container" itemprop="articleBody"> <p>One of the greatest features of <strong>Titanium</strong> relies on its high modularity. The SDK can be easily extended using modules, and when it comes to <strong>Alloy</strong>, code can be split into several parts called <em>widgets</em>. However, what is the cost of using a <em>widget</em>? What impact does a <code>require</code> have on the performance?</p> <!--more--> <h3 id="little-benchmark">Little Benchmark</h3> <p>In order to test the cost of using a widget, we have ran some benchmark tests on different devices (Samsung Galaxy S3, Archos Neon, LG D855, iPhone 4, iPhone 5s). Several widget compositions have been created such that at the end, the result will constitute in a window containing 10 labels.</p> <ul> <li><strong>benchmark_10</strong>: The reference one, this is a single widget containing 10 identical labels.</li> <li><strong>benchmark_2x5</strong>: This one is the above one split in two widgets, each of them containing 5 labels. So, there is 2 imports.</li> <li><strong>benchmark_10x1</strong>: Here, each label has been placed into a single widget; This result in 10 imports for Alloy.</li> <li><strong>benchmark_5x1p5</strong>: 5 labels are directly placed into the window, the other 5 one have been placed into separated widget. 5 imports.</li> <li><strong>benchmark_2x2x2p1</strong>: This one aims at testing the impact of nested widgets. There are 2 widgets containing 2 widgets and one label. Each of the latter 2 widgets contains also two widgets that encapsulate a single label. Thus, there are 6 imports in total.</li> </ul> <p>Now, what are we measuring exactly? The time it takes to create a widget from a controller.</p> <figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">widget</span> <span class="o">=</span> <span class="nx">Alloy</span><span class="p">.</span><span class="nx">createWidget</span><span class="p">(</span><span class="s2">&quot;benchmark_xxx&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">Ti</span><span class="p">.</span><span class="nx">API</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">now</span><span class="p">);</span></code></pre></figure> <p>We have ran the tests multiple times and took the average. The first benchmark (<em>benchmark_10</em>) is use a reference of the time it cost to create all 10 labels. Therefore, what we are measuring is the deviation from this reference, weighted by the number of widgets to require / create.</p> <h3 id="results">Results</h3> <p>Results are quite interesting and encouraging. For each device, the instantiation time is under <code>1ms</code> and under <code>350us</code> for most of them (R.I.P iPhone 4…). Also, the more widgets are required, the less it takes to require one of them. However, this seems not to be relevant enough and it’s probably due to the fact that every widget is composed of the same Label element. Titanium or the device itself might be able to process some sort of cache to speed up the view creation.</p> <p>Also, nesting widget seems to slow a bit the require time for any device. However.. Except for the Archos which is definitely not a great warrior in this battle, the additional time might be ignored.</p> <p>Here are the results, (measure unit are micro seconds per widget):</p> <table> <thead> <tr> <th>Device</th> <th>Benchmark_2x5</th> <th>Benchmark_5x1p5</th> <th>Benchmark_2x2x2p1</th> <th>Benchmark_10x1</th> </tr> </thead> <tbody> <tr> <td>Archos Neon</td> <td>619</td> <td>589</td> <td>818</td> <td>485</td> </tr> <tr> <td>LG D855</td> <td>619</td> <td>366</td> <td>380</td> <td>337</td> </tr> <tr> <td>Galaxy S3</td> <td>354</td> <td>310</td> <td>334</td> <td>333</td> </tr> <tr> <td>iPhone 5s</td> <td>313</td> <td>270</td> <td>289</td> <td>263</td> </tr> <tr> <td>iPhone 4</td> <td>776</td> <td>946</td> <td>962</td> <td>937</td> </tr> </tbody> </table> <h3 id="bilan">Bilan</h3> <p>The benchmarks (what a huge word for some measures of time) comfort us in the idea that the readability and the high level of maintainability brought by a the modular architecture do not impact the performance that much. When requiring about 50 different widgets, the overall cost brought by those calls is less than <code>50ms</code> and could be easily done on start-up. Component-driven development for mobile application sounds even more promising.</p> </div> </article> <footer class="site-footer"> <div class="container"> <ul class="social"> <li><a href="http://github.com/KtorZ" target="_blank"><i class="icon icon-github"></i></a></li> <li><a href="http://linkedin.com/in/matthias-benkort-47186a57" target="_blank"><i class="icon icon-linkedin"></i></a></li> <li><a href="http://twitter.com/mbenkort" target="_blank"><i class="icon icon-twitter"></i></a></li> </ul> <p> <small>&copy;2016 All rights reserved. Made with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and ♥</small> </p> </div> </footer> </main> <script src="/assets/js/jquery-2.1.1.js"></script> <script src="/assets/js/main.js"></script> </body> </html><!-- by nandomoreira.me -->